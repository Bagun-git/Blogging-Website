<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Home | MYBLOGSPACE</title>
  <link rel="stylesheet" href="home.css" />
  <script src="/home.js" defer></script>
</head>

<body>
  <!-- Sidebar -->
  <div class="sidebar">
    <h2>MYBLOGSPACE</h2>
    <nav>
      <a href="home" class="active">Home</a>
      <a href="notification">Notifications</a>
      <a href="messages">Messages</a>
      <a href="profil">Profile</a>
      <a href="login">Logout</a>
    </nav>
    <a href="create-blog.html">
    <button class="post-btn">Create Blog</button>
    </a>
  </div>

  <!-- Main Feed -->
<div class="main">
  <div class="top-bar">
    <h2>Feed</h2>
  </div>

  <% blogs.forEach(blog => { %>
    <div class="tweet">
      <div class="user"><strong>
         <% if (blog.authorId && blog.authorId._id) { %><a href="/user/<%= blog.authorId._id %>">
         <span class="username"> @<%= blog.authorName || "Anonymous" %></span></a>
     <% } else { %>
      @<%= blog.authorName || "Anonymous" %>
     <% } %></strong>
      <% if (blog.authorId && blog.authorId._id) { 
     const isSelf = blog.authorId._id.equals(currentUserId);
     const isFollowing = blog.authorId.followers && blog.authorId.followers.includes(currentUserId);
      %>
      <% if (!isSelf) { %>
        <button type="button"
      class="followBtn <%= isFollowing ? 'following' : 'follow' %>"
      data-userid="<%= blog.authorId._id %>">
      <%= isFollowing ? 'Following' : 'Follow' %>
      </button>
      <% } %>
      <% } %>
      
       </div>
      <h3><%= blog.title %></h3>
      <p><%= blog.content %></p>
      <% if (blog.imagePath) { %>
        <img src="<%= blog.imagePath %>" alt="Blog Image" width="300" />
      <% } %>
      <hr />
    </div>
  <% }) %>
</div>


  <!-- Right Panel -->
  <div class="right-panel">
    <div class="search-bar">
      <input type="text"id="searchInput" placeholder="Search" autocomplete="off"/>
      <div id="searchResults" class="search-results"></div>
    </div>

    <div class="who-to-follow">
      <h3>Follow more</h3>

      <div class="user-suggestion">
        <img src="virat.jpg" alt="Virat" />
        <div>
          <strong>Virat Kohli</strong><br>
          <span>@imVkohli</span>
        </div>
        <button>Follow</button>
      </div>

      <div class="user-suggestion">
        <img src="rihanna.jpg" alt="Rihanna" />
        <div>
          <strong>Rihanna</strong><br>
          <span>@rihanna</span>
        </div>
        <button>Follow</button>
      </div>

      <a href="#" class="show-more">Show more</a>
    </div>
  </div>
</body>
</html>
